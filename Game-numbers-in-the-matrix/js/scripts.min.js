function depictField(){for($("#playingField").append('<div class="textNumberColumn"></div>'),e=1;e<=9;e++){var i=$("<div/>",{class:"numberColumn",text:e});$(".textNumberColumn").append(i)}for(var e=1;e<=playingField.length;e++){var o=$("<div/>",{id:"row"+e,class:"gaming-row"}),n=playingField[e-1];$("#playingField").append(o),$("#row"+e).append('<div class="textNumberRow">'+e+"</div>");for(var t=1;t<=playingField[e-1].length;t++){var l=$("<div/>",{id:"row"+e+"_col"+t,class:"gaming-cage"});$("#row"+e).append(l),$("#row"+e+"_col"+t).text(n[t-1]),0==$("#row"+e+"_col"+t).text()&&$("#row"+e+"_col"+t).addClass("zero")}/^0{9}$/.test($("#row"+e).text().slice(1))&&$($("#row"+e)).hide()}}function matchPlayField(i){function e(i){return i.concat(strArr.match(/.{9}/g).map(function(i){return i.split("").map(function(i){return parseInt(i)})}))}return strArr.length<=9?i.concat([strArr.split("").map(function(i){return parseInt(i)})]):strArr.length%9==0?e(i):e(i).concat([strArr.slice(-strArr.length%9).split("").map(function(i){return parseInt(i)})])}function checkFields(){if((valueField==valueFieldSecond||+valueField+ +valueFieldSecond==10)&&positionField.join("")!=positionFieldSecond.join("")){var i=1,e=1;if(positionField[0]==positionFieldSecond[0]){for(;0==playingField[+positionField[0]-1][+positionField[1]-1+i];)i++;if(positionField[1]==positionFieldSecond[1]-i)return!0;for(i=1;0==playingField[+positionField[0]-1][+positionField[1]-1-i];)i++;if(positionField[1]-i==positionFieldSecond[1])return!0}if(positionField[1]==positionFieldSecond[1]){if(positionField[0]<positionFieldSecond[0])for(;0==playingField[+positionField[0]-1+e][+positionField[1]-1];)e++;if(positionField[0]==positionFieldSecond[0]-e)return!0;if(e=1,positionField[0]>positionFieldSecond[0])for(;0==playingField[+positionField[0]-1-e][+positionField[1]-1];)e++;if(positionField[0]-e==positionFieldSecond[0])return!0}if(1==difficultyOfTheGame){var o=9*+positionField[0]+ +positionField[1]-9,n=9*+positionFieldSecond[0]+ +positionFieldSecond[1]-9;return!!(/^0*$/.test(playingField.join("").replace(/,/g,"").slice(o,n-1))&&o<n)||!!(/^0*$/.test(playingField.join("").replace(/,/g,"").slice(n,o-1))&&o>n)}if(0==difficultyOfTheGame){if((9==positionField[1]||0==playingField[+positionField[0]-1][+positionField[1]-1+i])&&1==positionFieldSecond[1]||0==playingField[+positionFieldSecond[0]-1][+positionFieldSecond[1]-1-i]){for(;0==playingField[+positionField[0]-1][+positionField[1]-1+i];)i++;if(i>9-positionField[1]){for(t=1;0==playingField[+positionFieldSecond[0]-1][+positionFieldSecond[1]-1-t];)t++;if(t>=9-(9-positionFieldSecond[1]))return!0}}if((9==positionFieldSecond[1]||0==playingField[+positionFieldSecond[0]-1][+positionFieldSecond[1]-1+i])&&1==positionField[1]||0==playingField[+positionField[0]-1][+positionField[1]-1-i]){for(;0==playingField[+positionFieldSecond[0]-1][+positionFieldSecond[1]-1+i];)i++;if(i>9-positionFieldSecond[1]){for(var t=1;0==playingField[+positionField[0]-1][+positionField[1]-1-t];)t++;if(t>=9-(9-positionField[1]))return!0}}}}}function infoBlock(){$("#infoGame > .countElements > p").text(countRemoveNumber),$("#infoGame > .countRows > p").text(countRowHidden),$("#infoGame > .countRun > p").text(countRuns),$("#infoGame > .firstClick > p").text("ряд "+positionField[0]+" колонка "+positionField[1]),$("#infoGame > .secondClick > p").text("ряд "+positionFieldSecond[0]+" колонка "+positionFieldSecond[1])}var valueField,valueFieldSecond,positionField,positionFieldSecond,startingGameBoard=[[1,2,3,4,5,6,7,8,9],[1,1,1,2,1,3,1,4,1],[5,1,6,1,7,1,8,1,9]],playingField,strArr,lastRowArr,lenLastRow,countRuns=0,countRemoveNumber=0,countRowHidden=0,difficultyOfTheGame=0;$("#btn-start-game").click(function(){$("#playingField").html()?($("#playingField").empty(),playingField=JSON.parse(JSON.stringify(startingGameBoard)),countRemoveNumber=0,countRuns=0,positionField=[0,0],positionFieldSecond=[0,0],countRowHidden=0,infoBlock(),depictField()):($("#btn-start-game").text("Новая игра"),playingField=JSON.parse(JSON.stringify(startingGameBoard)),depictField())}),$("#btn-next-move").click(function(){if(""===(strArr=playingField.join("").replace(/[0,]/g,"")))return!1;lastRowArr=playingField[playingField.length-1],lenLastRow=lastRowArr.join("").length,9!=lastRowArr.length?(lastRowArr=lastRowArr.concat(strArr.slice(0,9-lastRowArr.length).split("").map(function(i){return parseInt(i)})),strArr=strArr.slice(9-lenLastRow),playingField[playingField.length-1]=lastRowArr,""==(playingField=strArr.length%9!=0||strArr.length<9?matchPlayField(playingField):playingField.concat(strArr.match(/.{9}/g).map(function(i){return i.split("").map(function(i){return parseInt(i)})})))[playingField.length-1]&&(playingField=playingField.slice(0,-1)),$("#playingField").empty(),depictField()):(playingField=matchPlayField(playingField),$("#playingField").empty(),depictField())}),$("#playingField").on("click",".gaming-cage",function(){if(void 0===valueField)valueField=$(this).text(),positionField=$(this).attr("id").match(/\d+/g),$(this).addClass("active"),countRuns++;else if(valueFieldSecond=$(this).text(),positionFieldSecond=$(this).attr("id").match(/\d+/g),checkFields()){$("#row"+positionField.join("_col")).removeClass("active").text(0).addClass("zero"),$(this).text(0).addClass("zero"),valueField=void 0,playingField[positionField[0]-1][positionField[1]-1]=0,playingField[positionFieldSecond[0]-1][positionFieldSecond[1]-1]=0,countRemoveNumber++;var i=new RegExp("^0{"+($(this).siblings().text().slice(1)+0).length+"}$");if(i.test($(this).siblings().text().slice(1)+0)&&($(this).parent().hide(),positionField[0]!=positionFieldSecond[0]&&countRowHidden++),(i=new RegExp("^0{"+($("#row"+positionField.join("_col")).siblings().text().slice(1)+0).length+"}$")).test($("#row"+positionField.join("_col")).siblings().text().slice(1)+0)&&($("#row"+positionField.join("_col")).parent().hide(),countRowHidden++),infoBlock(),countRowHidden>=playingField.length)return $("#playingField").empty(),$("#playingField").append('<div class="win">Поздравляем, вы выйграли!</div>'),!1}else $("#row"+positionField.join("_col")).removeClass("active"),valueField=void 0,infoBlock()}),$("#btn-easy-difficulty").click(function(){difficultyOfTheGame=0,$(".difficultyOfTheGame > p").text("Легко"),$("#btn-start-game").click()}),$("#btn-hard-difficulty").click(function(){difficultyOfTheGame=1,$(".difficultyOfTheGame > p").text("Сложно"),$("#btn-start-game").click()});